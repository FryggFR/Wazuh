<!--
  Ruleset for Stormshield
  Author: Jonathan G.
  Work in progress...

  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->
<group name="stormshield">

  <rule id="300000" level="0">
    <decoded_as>stormshield_decoder</decoded_as>
    <description>Stormshield grouping rule</description>
  </rule>
  
  <rule id="300001" level="3">
    <if_sid>300000</if_sid>
    <action>pass</action>
    <description>$(fw) : firewall pass event.</description>
  </rule>
  
  <rule id="300002" level="5">
    <if_sid>300000</if_sid>
    <action>block</action>
    <description>$(fw) : firewall block event.</description>
  </rule>
  
  <rule id="300003" level="3">
    <if_sid>300000</if_sid>
     <field name="msg">SYSTEM IDENT</field>
     <field name="error">0</field>
     <description>$(fw) : Authentification succes.</description>
  </rule>
  
  <rule id="300004" level="5">
     <if_sid>300000</if_sid>
     <field name="msg">SYSTEM IDENT</field>
     <field name="error">1</field>
     <description>$(fw) : Authentification Failed.</description>
  </rule>
  
  <rule id="300005" level="12" frequency="3" timeframe="120" ignore="60">
     <if_matched_sid>300004</if_matched_sid>
     <same_field>address</same_field>
     <description>$(fw) : Multiple authentification failed, possible bruteforce attack.</description>
  </rule>
  
  <rule id="300006" level="12">
     <if_sid>300000</if_sid>
     <list field="data.dst" lookup="not_address_match_key">etc/lists/blacklist-alienvault</list>
     <description>$(fw) : Trafic to blacklisted (Alienvault) IP detected: $dst - possible malware activity</description>
  </rule>
 
</group>
